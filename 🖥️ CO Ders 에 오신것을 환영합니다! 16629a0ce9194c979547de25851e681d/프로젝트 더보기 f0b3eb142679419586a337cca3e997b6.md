# 프로젝트 더보기

## **프로젝트 소개**

---

### **배경**

![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%83%E1%85%A5%E1%84%87%E1%85%A9%E1%84%80%E1%85%B5%20f0b3eb142679419586a337cca3e997b6/Untitled.png)

![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%83%E1%85%A5%E1%84%87%E1%85%A9%E1%84%80%E1%85%B5%20f0b3eb142679419586a337cca3e997b6/Untitled%201.png)

**최근 영상 공유 플랫폼들이 늘어났고, 이에 따라 플랫폼에 업로드 된 영상은 순식간에 불특정 다수에게 공유됩니다. 특정 인터뷰 영상과 같이 신분을 감춰야 하거나 허가 받지 않은 촬영의 경우 초상권 보호를 위해 모자이크 기법이 종종 사용됩니다. 그러나 모자이크는 부정적인 이미지를 줄 수 있고, 또 영상에 어색함을 느끼게 할 수 있다는 단점이 있습니다. 저희는 자연스러운 영상 제작과 초상권 보호를 위해 가상 얼굴 합성 서비스 KEEP:R를 개발하고자 하였습니다.**

### **제공 서비스**

**본 웹사이트 KEEP:R는 가상 얼굴을 생성하여 영상 속 인물의 얼굴을 가상 얼굴로 변환하는 서비스를 제공합니다.**

![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%83%E1%85%A5%E1%84%87%E1%85%A9%E1%84%80%E1%85%B5%20f0b3eb142679419586a337cca3e997b6/Untitled%202.png)

### **기대효과**

**이질감 없는 자연스러운 영상 합성을 통해 초상권을 보호하는 동시에 시각적인 안정감을 줄 수 있을 것이라 기대함.**

## **사용 기술 소개**

---

### **1) 가상 얼굴 생성**

**Target Image to Latent Vector**

- **타겟의 얼굴과 이질감이 적은 자연스러운 얼굴을 생성하기 위해 Encoding 과정을 거침.**
- **4000개의 이미지와 latent vector 쌍으로 이루어진 데이터셋을 구축하여 이미지를 latent vector로 변환하는 Encoder를 학습시킴.**

![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%83%E1%85%A5%E1%84%87%E1%85%A9%E1%84%80%E1%85%B5%20f0b3eb142679419586a337cca3e997b6/Untitled%203.png)

**Latent Vector To Virtual Face Image**

- **사전에 학습된 이미지 생성 모델인 styleGAN을 사용함.**
- **Encoding한 타겟 얼굴의 latent vector에 노이즈를 추가하여 서로 다른 9개의 가상 얼굴을 생성하도록 함.**

![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%83%E1%85%A5%E1%84%87%E1%85%A9%E1%84%80%E1%85%B5%20f0b3eb142679419586a337cca3e997b6/Untitled%204.png)

**Skin Color Control**

- **Kmeans Clustering을 이용하여 타겟 얼굴과 가상 얼굴의 피부색을 HSV 형식으로 추출함.**
- **가상 얼굴의 피부 영역을 masking 한 후, 기존 명암은 유지한 채 피부색만 타켓 얼굴의 피부색으로 변환함.**

![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%83%E1%85%A5%E1%84%87%E1%85%A9%E1%84%80%E1%85%B5%20f0b3eb142679419586a337cca3e997b6/Untitled%205.png)

### **2) 인물 합성**

**Motion-Supervised Co-Part Segmentation**

- **영상에서 사전에 학습된 정보를 바탕으로 의미 있는 얼굴 segment를 찾음. (e.g. 입, 눈, 코 등)**
- **가상 얼굴과 타겟 얼굴의 segment들을 찾고, 각 segment들을 indexing하여 원하는 부분을 1대1로 교환함.**

![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%83%E1%85%A5%E1%84%87%E1%85%A9%E1%84%80%E1%85%B5%20f0b3eb142679419586a337cca3e997b6/Untitled%206.png)

## **웹 페이지 구성**

---

1. **영상 업로드**

![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%83%E1%85%A5%E1%84%87%E1%85%A9%E1%84%80%E1%85%B5%20f0b3eb142679419586a337cca3e997b6/Untitled%207.png)

1. **가상 얼굴 생성 및 선택**

![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%83%E1%85%A5%E1%84%87%E1%85%A9%E1%84%80%E1%85%B5%20f0b3eb142679419586a337cca3e997b6/Untitled%208.png)

**원본 영상**

![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%83%E1%85%A5%E1%84%87%E1%85%A9%E1%84%80%E1%85%B5%20f0b3eb142679419586a337cca3e997b6/Untitled%209.png)

1. **타켓 얼굴 추출**

![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%83%E1%85%A5%E1%84%87%E1%85%A9%E1%84%80%E1%85%B5%20f0b3eb142679419586a337cca3e997b6/Untitled%2010.png)

1. **가상 얼굴 합성**

![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%83%E1%85%A5%E1%84%87%E1%85%A9%E1%84%80%E1%85%B5%20f0b3eb142679419586a337cca3e997b6/Untitled%2011.png)

**생성된 영상**

![Untitled](%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A6%E1%86%A8%E1%84%90%E1%85%B3%20%E1%84%83%E1%85%A5%E1%84%87%E1%85%A9%E1%84%80%E1%85%B5%20f0b3eb142679419586a337cca3e997b6/Untitled%2012.png)

## References

---

- T. Karrs, T. Aila, S. Laine, and J. Lehtinen. Progressive growing of GANs for improved quality, stability, and variation. ICLR 2018
- T. Karrs, T. Aila, S. Laine, and J. Lehtinen A Style-Based Generator Architecture for Generative Adversarial Networks. CVPR 2019
- https://towardsdatascience.com/explained-a-style-based-generator-architecture-for-gans-generating-and-tuning-realistic-6cb2be0f431
- [https://pixabay.com/ko/videos/](https://pixabay.com/ko/videos/)
- Siarohin, A., Roy, S., Lathuilière, S., Tulyakov, S., Ricci, E., & Sebe, N. (2021). Motion-supervised Co-Part Segmentation. CVPR 2020
- [https://pyimagesearch.com/2014/05/26/opencv-python-k-means-color-clustering/](https://pyimagesearch.com/2014/05/26/opencv-python-k-means-color-clustering/)